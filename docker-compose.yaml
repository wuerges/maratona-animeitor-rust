version: "3.7"
services:
  animeitor:
    image: wuerges/animeitor:latest
    # image: wuerges/animeitor:0.5.0
    command: "--sedes ${SEDES} --secret ${SECRET} ${BOCA_URL} --port 8000"
    ports: 
      - 8000:8000
    volumes:
      - ./tests:/tests
      - ./config:/config

    build: 
      context: server
      args:
        - DOCKER_BUILDKIT=1

  printurls:
    image: wuerges/animeitor:latest
    # image: wuerges/animeitor:0.5.0
    command: "--sedes ${SEDES} --secret ${SECRET} --prefix ${URL_PREFIX}"
    volumes:
      - ./config:/config
    entrypoint: /printurls

    build: 
      context: server
      args:
        - DOCKER_BUILDKIT=1

  animeitor-client:
    image: wuerges/animeitor-client:latest
    # image: wuerges/animeitor-assets:0.5.0
    ports: 
      - ${HTTP_PORT}:80
    volumes:
      - /server/photos:/usr/share/nginx/photos

    build: 
      context: .
      dockerfile: client.Dockerfile
      args:
        - URL_PREFIX=${URL_PREFIX}